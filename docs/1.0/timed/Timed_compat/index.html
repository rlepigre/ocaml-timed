<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Timed_compat (timed.Timed_compat)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../index.html">timed</a> &#x00BB; Timed_compat</nav><header class="odoc-preamble"><h1>Module <code><span>Timed_compat</span></code></h1><p>Timed references for <code>Stdlib</code>.ref. This module redefines the functions used to update references, and enables the restoration of saved reference states.</p><ul class="at-tags"><li class="author"><span class="at-tag">author</span> Christophe Raffalli</li></ul><ul class="at-tags"><li class="author"><span class="at-tag">author</span> Rodolphe Lepigre</li></ul></header><div class="odoc-content"><p>Note that this module allocates one blocks of memory at initialization for its internal state. It occupies a total of four words.</p><div class="odoc-spec"><div class="spec value" id="val-(:=)" class="anchored"><a href="#val-(:=)" class="anchor"></a><code><span><span class="keyword">val</span> (:=) : <span><span><span class="type-var">'a</span> <span class="xref-unresolved">Stdlib</span>.ref</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>r := v</code> sets the value of the reference <code>r</code> to <code>v</code>. This operation has a very small overhead compared to <code>Stdlib</code>.((:=)) if no time has been saved with <a href="Time/index.html#val-save"><code>Time.save</code></a>. Nonetheless, it is always constant time. Note that this function does not perform any memory allocation, except when the current “time” is accessible (or has not been collected). When that is the case, three blocks of memory are allocated, for a total of eight words.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-incr" class="anchored"><a href="#val-incr" class="anchor"></a><code><span><span class="keyword">val</span> incr : <span><span>int <span class="xref-unresolved">Stdlib</span>.ref</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>incr r</code> is equivalent to <code>r := !r + 1</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-decr" class="anchored"><a href="#val-decr" class="anchor"></a><code><span><span class="keyword">val</span> decr : <span><span>int <span class="xref-unresolved">Stdlib</span>.ref</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>decr r</code> is equivalent to <code>r := !r - 1</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Time" class="anchored"><a href="#module-Time" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Time/index.html">Time</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The <code>Time</code> module provides an abstract representation of time, used to set a point from which (monitored) updates to references are recorded to allow undoing/redoing the corresponding changes.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pure_apply" class="anchored"><a href="#val-pure_apply" class="anchor"></a><code><span><span class="keyword">val</span> pure_apply : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>pure_apply f v</code> computes the result of <code>f v</code>, but reverts the (monitored) updates made to references in the process before returning the value.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pure_test" class="anchored"><a href="#val-pure_test" class="anchor"></a><code><span><span class="keyword">val</span> pure_test : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>pure_test p v</code> applies the predicate <code>p</code> to <code>v</code> (i.e., compute <code>p v</code>) and returns the result, reverting (monitored) updates made to reference if the result is <code>false</code>. Updates are preserved if the result is <code>true</code>.</p></div></div></div></body></html>